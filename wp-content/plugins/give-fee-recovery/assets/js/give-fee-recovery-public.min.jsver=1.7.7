var give_global_vars,Give_Fee_Recovery;jQuery.noConflict(),function(e){Give_Fee_Recovery={init:function(){e(".give-form-wrap").each(function(){var a=e(this).find(".give-form"),i=a.find(".give-fee-disable").val(),n=!!parseInt(i),t=a.find("input.give-gateway:radio:checked").val(),f=a.find('input[name="give-amount"]').val();e(this).find(".give-fee-message").hide(),n&&e(this).find(".give-fee-message").show(),n&&Give_Fee_Recovery.give_fee_update(a,!0,f,t)})},give_fee_update:function(a,i,n,t){var f=a.find(".give-final-total-amount"),o=a.find(".give-fee-message-label-text"),v=a.find(".fee-break-down-message"),r=v.data("breakdowntext"),d=a.find(".give_fee_mode_checkbox").val(),_=Give.form.fn.getInfo("decimal_separator",a),g=give_fee_unformat_amount(n,_),u=JSON.parse(a.find('input[name="give-fee-recovery-settings"]').val());if(a.has(".give_fee_mode_checkbox").length>=1&&0!==d&&"undefined"!==d&&(i=a.find(".give_fee_mode_checkbox").is(":checked")),0===a.find(".give-fee-message").length)return!1;f.show(),v.hide();var m=u.fee_recovery,s=u.fee_data.all_gateways,c=0,l=0,p=!0,y=!0,h=!1,b=0;if(m){s?(c=u.fee_data.all_gateways.base_amount,l=u.fee_data.all_gateways.percentage,p=u.fee_data.all_gateways.is_break_down,y=u.fee_data.all_gateways.give_fee_status,h=u.fee_data.all_gateways.give_fee_disable):jQuery.each(u.fee_data,function(e,a){t===e&&(c=a.base_amount,l=a.percentage,p=a.is_break_down,y=a.give_fee_status,h=a.give_fee_disable)});var w=give_fee_recovery_object.give_fee_zero_based_currency,G=JSON.parse(w),k=Give.form.fn.getInfo("currency_code",a),x=Give.form.fn.getInfo("number_decimals",a);1>=parseInt(x)&&-1===jQuery.inArray(k,G)&&(x=2),b=give_fee_calculate(l,c,give_fee_unformat_amount(n,_),h),-1!==jQuery.inArray(k,G)&&(x=0,b=Math.ceil(b)),i&&(g+=give_fee_unformat_amount(Give.fn.formatCurrency(b,{precision:x},a)));var F=r.replace("{amount}",give_fee_format_amount(give_fee_unformat_amount(n,_),a)),R=F.replace("{fee_amount}",give_fee_format_amount(b,a));h?(a.find(".give-fee-recovery-donors-choice").hide(),a.find(".fee-coverage-required").hide()):(a.parent().hasClass("mfp-content")||a.find(".give-fee-recovery-donors-choice").show(),a.find(".fee-coverage-required").show()),y?(a.find('input[name="give-fee-status"]').remove(),a.prepend('<input type="hidden" name="give-fee-status" value="enabled"/>')):(a.find('input[name="give-fee-status"]').remove(),a.prepend('<input type="hidden" name="give-fee-status" value="disabled"/>')),i&&p&&"undefined"!=typeof r&&(v.show(),a.find('input[name="give-payment-mode"]').remove(),a.prepend('<input type="hidden" name="give-payment-mode" value="'+t+'"/>'),v.text(R));var j=a.find(".give-fee-message-label").data("feemessage"),C=j.replace("{fee_amount}",give_fee_format_amount(b,a));o.text(C);var x;x="undefined"!=typeof give_global_vars?give_global_vars.number_decimals:give_vars.currency_decimals,1>=parseInt(x)&&(x=2),setTimeout(function(){f.text(give_fee_format_amount(g,a)).attr("data-total",Give.fn.formatCurrency(g,{precision:x},a))},0),0===give_fee_unformat_amount(Give.fn.formatCurrency(b,{precision:x},a))?(v.hide(),o.hide(),e(".give-fee-message-label").hide()):(o.show(),e(".give-fee-message-label").show()),a.find('input[name="give-fee-mode-enable"]').remove(),a.prepend('<input type="hidden" name="give-fee-mode-enable" value="'+i+'"/>'),a.find('input[name="give-fee-amount"]').remove(),a.prepend('<input type="hidden" name="give-fee-amount" value="'+give_fee_unformat_amount(Give.fn.formatCurrency(b,{precision:x},a))+'"/>')}else a.find('input[name="give-fee-status"]').remove(),a.prepend('<input type="hidden" name="give-fee-status" value="disabled"/>')}},e(function(){var a=e("body");a.on("change",".give_fee_mode_checkbox",function(){var a=e(this).closest("form.give-form"),i=e(this).is(":checked"),n=a.find("input.give-gateway:radio:checked").val(),t=a.find('input[name="give-amount"]').val();Give_Fee_Recovery.give_fee_update(a,i,t,n)}).change(),e(document).on("give_donation_value_updated",function(a,i,n){i||(i=e(this).closest("form.give-form"));var t=i.find("input.give-gateway:radio:checked").val(),f="undefined"==typeof n?i.find('input[name="give-amount"]').val():n;Give_Fee_Recovery.give_fee_update(i,!0,f,t)}),e(document).on("give_gateway_loaded",function(a,i,n){var t=e(a.currentTarget.activeElement).closest("form.give-form");0===t.length&&(t=e("#"+n));var f=t.find('li.give-gateway-option-selected input[name="payment-mode"]').val(),o=t.find('input[name="give-amount"]').val();Give_Fee_Recovery.give_fee_update(t,!0,o,f)}),Give_Fee_Recovery.init()})}(jQuery);